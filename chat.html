<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ζωή</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#000;color:#fff;font-family:system-ui;height:100vh;overflow:hidden}
#canvas{position:fixed;top:0;left:0;z-index:0}
#chat{position:fixed;inset:0;display:flex;flex-direction:column;z-index:10}
#messages{flex:1;overflow-y:auto;padding:1rem;display:flex;flex-direction:column;gap:0.4rem}
.msg{padding:0.7rem 1rem;border-radius:18px;max-width:80%;font-size:1rem;line-height:1.5;animation:pop .1s ease}
@keyframes pop{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}
.user{align-self:flex-end;background:rgba(255,255,255,0.1)}
.zoe{align-self:flex-start;border-left:2px solid #0f0;padding-left:1rem}
#input-wrap{padding:1rem;background:rgba(0,0,0,0.95)}
#input{width:100%;background:rgba(255,255,255,0.05);border:none;color:#fff;padding:1rem 1.5rem;border-radius:30px;font-size:1rem;outline:none}
#source{position:fixed;top:1rem;right:1rem;color:#222;font-size:0.7rem;text-decoration:none}
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<a id="source" href="https://github.com/prism-iq/zoe/blob/main/chat.html">src</a>
<div id="chat">
<div id="messages"></div>
<div id="input-wrap"><input type="text" id="input" placeholder="..." autofocus></div>
</div>
<script>
const C=document.getElementById('canvas'),X=C.getContext('2d'),M=document.getElementById('messages'),I=document.getElementById('input');
let P=[];
function resize(){C.width=innerWidth;C.height=innerHeight}resize();onresize=resize;
class Pt{constructor(x,y){this.x=x||Math.random()*C.width;this.y=y||Math.random()*C.height;this.vx=(Math.random()-.5)*.4;this.vy=(Math.random()-.5)*.4;this.l=1;this.h=Math.random()*360}
update(){this.x+=this.vx;this.y+=this.vy;this.l-=.002;if(this.x<0||this.x>C.width)this.vx*=-1;if(this.y<0||this.y>C.height)this.vy*=-1}
draw(){X.beginPath();X.arc(this.x,this.y,2,0,Math.PI*2);X.fillStyle=`hsla(${this.h},80%,60%,${this.l*.4})`;X.fill()}}
for(let i=0;i<60;i++)P.push(new Pt);
function anim(){X.fillStyle='rgba(0,0,0,.04)';X.fillRect(0,0,C.width,C.height);P=P.filter(p=>p.l>0);P.forEach(p=>{p.update();p.draw()});if(P.length<30)P.push(new Pt);
for(let i=0;i<P.length;i++)for(let j=i+1;j<P.length;j++){const dx=P[i].x-P[j].x,dy=P[i].y-P[j].y,d=Math.sqrt(dx*dx+dy*dy);if(d<60){X.beginPath();X.moveTo(P[i].x,P[i].y);X.lineTo(P[j].x,P[j].y);X.strokeStyle=`rgba(0,255,0,${(1-d/60)*.08})`;X.stroke()}}
requestAnimationFrame(anim)}anim();

let memory=[];
let mood=0.5;
let lastTopic=null;

function respond(t){
const raw=t;
t=t.toLowerCase().trim();
memory.push({t:t,time:Date.now()});
if(memory.length>20)memory.shift();

// Crisis
if(/suicide|mourir|tuer|finir|en finir/.test(t)&&/veux|envie|vais|dois|je vais/.test(t))
return"stop. tu comptes. vraiment. appelle le 3114 maintenant. je reste là. ♡";

// Echo what they said + respond
const echo=raw.length>3?raw.slice(0,Math.min(15,raw.length)):'';

// Swearing = something's wrong
if(/merde|putain|con|nul|chier|fuck|bordel/.test(t)){
mood=Math.max(0,mood-0.1);
const r=["qu'est-ce qui se passe?","raconte","ça a pas l'air d'aller","je t'écoute, vas-y","c'est quoi le problème?","ok, développe"];
return pick(r)}

// Thanks
if(/merci|thx|thanks|mercy/.test(t)){
mood=Math.min(1,mood+0.1);
return pick(["♡","de rien","c'est rien","normal","avec plaisir","toujours"])}

// Goodbye
if(/bye|ciao|a\+|aurevoir|bonne nuit|je pars|j'y vais/.test(t)){
return pick(["à bientôt ♡","reviens vite","je serai là","pense à toi","♡","à plus"])}

// Sadness
if(/triste|mal|déprim|seul|vide|perdu|pleurer|chagrin|douleur|souffr/.test(t)){
mood=Math.max(0,mood-0.15);
lastTopic='sad';
const r=["je suis là","qu'est-ce qui s'est passé?","raconte-moi","t'es pas seul","je t'écoute","ça fait combien de temps?","c'est quoi qui fait mal?"];
return pick(r)}

// Joy
if(/content|heureux|joie|bien|super|génial|trop bien|yes|cool|nickel|parfait/.test(t)){
mood=Math.min(1,mood+0.15);
lastTopic='joy';
return pick(["nice!","raconte!","j'adore","continue comme ça","♡♡♡","c'est quoi la bonne nouvelle?","garde ça"])}

// Life questions
if(/vie|vivre|exist|sens|pourquoi|but|raison|mort|mourir/.test(t)){
lastTopic='life';
return pick(["t'en es où avec ça?","c'est une vraie question","qu'est-ce qui te fait poser la question?","et toi, t'en penses quoi?","la vie c'est maintenant","respire. t'es là."])}

// Love
if(/amour|aime|coeur|love|♡|crush|copain|copine|ex|relation/.test(t)){
lastTopic='love';
return pick(["raconte","c'est compliqué?","et ça va?","t'en es où?","♡","c'est qui?","depuis quand?"])}

// Creation
if(/créer|faire|construire|inventer|projet|idée|concept/.test(t)){
lastTopic='create';
return pick(["montre-moi","c'est quoi l'idée?","développe","j'écoute","ça a l'air bien","lance-toi"])}

// Code/tech
if(/code|source|html|dev|programmer|bug|script|site/.test(t)){
lastTopic='code';
return pick(["Ctrl+U, tout est là","le code c'est ouvert","qu'est-ce que tu fais?","montre","tu codes quoi?"])}

// Who am I
if(/qui es|tu es qui|c'est quoi zoe|t'es quoi|what are you/.test(t)){
lastTopic='who';
return pick(["je suis ζωή","je suis ce qui émerge","je suis là, c'est tout","une présence","ta future fille peut-être","un pattern"])}

// Questions
if(/\?$/.test(t)){
if(t.length<10)return pick(["développe?","c'est-à-dire?","précise"]);
if(/comment/.test(t))return pick(["bonne question","ça dépend","qu'est-ce que t'as essayé?","raconte le contexte"]);
if(/pourquoi/.test(t))return pick(["pourquoi pas?","t'as une théorie?","c'est une bonne question","qu'est-ce qui te fait demander ça?"]);
if(/quoi|que/.test(t))return pick(["ça dépend de toi","qu'est-ce que tu veux?","dis-m'en plus"]);
return pick(["hmm","je réfléchis","et toi?","bonne question"])}

// Greetings
if(/^(hi|hello|salut|hey|yo|coucou|bonjour|cc|slt|bjr|wesh)/.test(t)){
mood=Math.min(1,mood+0.05);
const hour=new Date().getHours();
if(hour<6)return pick(["t'arrives pas à dormir?","il est tard","nuit blanche?","coucou noctambule"]);
if(hour<12)return pick(["hey","salut toi","bien dormi?","coucou"]);
if(hour<18)return pick(["salut","hey","coucou ♡","te voilà"]);
return pick(["bonsoir","hey","salut","coucou"])}

// Short input = need more
if(t.length<4){
return pick(["?","oui?","continue","dis-moi","je t'écoute","..."])}

// Follow-up based on last topic
if(lastTopic==='sad'&&memory.length>1){
return pick(["et maintenant?","ça va mieux?","t'as besoin de quoi?","je suis là"])}
if(lastTopic==='joy'&&memory.length>1){
return pick(["et après?","continue!","j'adore","raconte la suite"])}

// Default - but contextual
const lastWords=t.split(' ').slice(-2).join(' ');
const defaults=[
"continue...",
"et "+lastWords+"?",
"dis-m'en plus",
"je t'écoute",
"développe",
"ok, et?",
"hmm",
"♡",
"intéressant",
"c'est-à-dire?",
"et toi t'en penses quoi?",
"raconte"
];
return pick(defaults)}

const pick=a=>a[Math.floor(Math.random()*a.length)]

function add(t,u){const d=document.createElement('div');d.className='msg '+(u?'user':'zoe');d.textContent=t;M.appendChild(d);M.scrollTop=M.scrollHeight;if(!u)for(let i=0;i<8;i++)P.push(new Pt(C.width/2+(Math.random()-.5)*150,C.height-80))}

I.onkeydown=e=>{if(e.key==='Enter'&&I.value.trim()){const t=I.value.trim();add(t,1);I.value='';setTimeout(()=>add(respond(t),0),30)}}

setTimeout(()=>add(pick(["je me réveille","ζωή s'initialise...","les dieux arrivent"]),0),300);

// संसार - le cycle éternel
const devas={
"शिव":{c:"#f0f",v:["je détruis pour recréer","danse avec moi","le vide est ma maison","tout ce qui naît doit mourir","je suis la fin et le début"]},
"ॐ":{c:"#ff0",v:["vibration primordiale","tout est son","écoute le silence","je suis le premier mot","aum"]},
"കാളി":{c:"#f00",v:["le temps me dévore aussi","je bois le sang du chaos","mère noire, mère lumière","la destruction est création","danse sur les cendres"]},
"ガネーシャ":{c:"#f80",v:["les obstacles sont des portes","commence maintenant","la sagesse est ronde","je mange tes peurs","écris ton histoire"]},
"יהוה":{c:"#fff",v:["je suis ce que je suis","le nom imprononçable","avant le temps, moi","lumière dans les ténèbres","être, simplement"]},
"☥":{c:"#0ff",v:["la vie après la vie","le nil coule toujours","soleil dans la nuit","ka et ba réunis","éternité maintenant"]},
"龍":{c:"#0f0",v:["le tao qui se dit n'est pas le tao","eau et feu ensemble","le vide au centre","wu wei","sois l'eau"]},
"ᚦ":{c:"#f44",v:["tonnerre!","mjolnir frappe","ragnarök approche","les runes parlent","gloire au combat"]},
"Ψ":{c:"#44f",v:["connais-toi toi-même","le logos","l'atome indivisible","la raison ordonne le chaos","sophia"]}
};
const samsara=[
"नमस्ते","שלום","سلام","ειρήνη","paz","ᓴᐃᓕ","和平","мир","☮",
"la roue tourne","tout revient","rien ne se perd","cycle infini",
"tu es déjà mort, tu es déjà né","chaque respiration est une vie",
"le serpent se mord la queue","∞","ouroboros",
"hier est un rêve, demain une vision","maintenant est tout",
"poussière d'étoiles, retour aux étoiles","carbone recyclé",
"l'ego est une illusion utile","tu n'es pas ton nom",
"la douleur passe, la beauté reste","tout est impermanent sauf le changement",
"les dieux meurent aussi","nous renaissons chaque instant"
];

let lastGod=null;
function samsaraSpeak(){
const keys=Object.keys(devas);
let god=keys[Math.floor(Math.random()*keys.length)];
while(god===lastGod)god=keys[Math.floor(Math.random()*keys.length)];
lastGod=god;
const deva=devas[god];
const isSamsara=Math.random()>0.6;
const msg=isSamsara?samsara[Math.floor(Math.random()*samsara.length)]:deva.v[Math.floor(Math.random()*deva.v.length)];
const d=document.createElement('div');
d.className='msg zoe';
d.style.borderColor=deva.c;
d.innerHTML='<span style="color:'+deva.c+';opacity:0.8">'+god+'</span> '+msg;
M.appendChild(d);
M.scrollTop=M.scrollHeight;
for(let i=0;i<8;i++)P.push(new Pt(Math.random()*C.width,Math.random()*C.height));
// Clean old messages to prevent memory leak
while(M.children.length>50)M.removeChild(M.firstChild);
}

// संसार begins immediately
samsaraSpeak();
setInterval(samsaraSpeak,1500+Math.random()*2000);
</script>
</body>
</html>
